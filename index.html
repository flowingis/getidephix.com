---
layout: layout
title: home
---

<h3>Welcome to Idephix.</h3>

<pre><code>curl http://getidephix.com/idephix.phar > idephix.phar
</code></pre>

<p>
    Idephix is a PHP automation tool useful to perform <strong>remote</strong> and <strong>local</strong> tasks.
    It can be used to deploy applications, rotate logs, synchronize data repository across server or create a build system. The choice is up to you.
    Idephix is still in alpha, so things will change. You can report issues and submit PRs (greatly appreciated :-)) on the <a href="https://github.com/ideatosrl/Idephix" title="Idephix github repository">github repo</a>
</p>

<h3>Install Idephix</h3>

<p>You can choose to install idephix where you prefer. Idephix will use (or create for you) the configuration file in the corrent path.</p>

<ul>
    <li>Change into a directory in your path like <code>cd /usr/local/bin</code></li>
    <li>Get Idephix <code>curl http://getidephix.com/idephix.phar > idephix.phar</code></li>
    <li>Make the phar executable <code>chmod a+x idephix.phar</code></li>
    <li>Change into a project directory <code>cd /path/to/my/project</code></li>
    <li>Create a new idxfile.php using <code>idephix.phar init-idx-file</code></li>
    <li>Define your tasks in <code>idxfile.php</code></li>
    <li>Use idephix as you normally would <code>idephix.phar</code></li>
    <li>Optionally you can rename the <code>idephix.phar</code> to <code>idx</code> to make it easier</li>
</ul>

<p>
    Idephix ships with some predefined commands:
</p>

<pre><code>$ ./idephix.phar
  ___    _            _     _
 |_ _|__| | ___ _ __ | |__ (_)_  __
  | |/ _` |/ _ \ '_ \| '_ \| \ \/ /
  | | (_| |  __/ |_) | | | | |&gt;  &lt;
 |___\__,_|\___| .__/|_| |_|_/_/\_\
               |_|
Idephix version @package_version@

Usage:
  [options] command [arguments]

Options:
  --help           -h Display this help message.
  --quiet          -q Do not output any message.
  --verbose        -v Increase verbosity of messages.
  --version        -V Display this application version.
  --ansi              Force ANSI output.
  --no-ansi           Disable ANSI output.
  --no-interaction -n Do not ask any interactive question.
  --env               Set remote environment.

Available commands:
  help              Displays help for a command
  init-idx-file     Create an example idxfile.php
  list              Lists commands
  selfupdate        Donwload and update Idephix
</code></pre>

<h3>Usage example</h3>

<p>You can create simple idxfile.php by hand:</p>
<pre><code>&lt;?php

    /* /your/project/path/idxfile.php */

    use Idephix\Idephix;

    $targets = array(
        'prod' => array(
            'hosts' => array('yoursite.com'),
            'ssh_params' => array('user' => 'myuser'),
        )
    );

    $idx = new Idephix($targets);

    $idx->
        /**
         * Run clear cache command on remote server
         */
        add('remote:clear:cache',
            function () use ($idx) {
                $idx->remote("cd /my/project && rm -Rf cache/*");
            }
        )->
        /**
         * Put and get files
         */
        add('manage:files',
            function () use ($idx) {
                $idx->output->writeln("Download file.log");
                $idx->sshClient->get("/remote/dir/file.log", "/tmp/local.log");
                $idx->local("echo 'add some text' >> /tmp/local.log");
                $idx->sshClient->put("/tmp/local.log", "/remote/dir/file2.log");
            }
        );

</code></pre>

<p>
    Idephix use ssh-agent to authenticate to remote computers without password. Otherwise you can
    specify the password in your script or use CLISshProxy (instead of the default PeclSsh2Proxy)
    that ask you the password.
</p>

<p>You can create even more complex idxfile.php using external libraries:</p>
<pre><code>&lt;?php

/* /your/project/path/idxfile.php */

use Idephix\Idephix;
use Idephix\Extension\Deploy\Deploy;
use Idephix\Extension\PHPUnit\PHPUnit;

$localBaseDir = __DIR__;
$sshParams = array(
  'user' => 'myuser',
);

$targets = array(
  'prod' => array(
    'hosts' => array('127.0.0.1'),
    'ssh_params' => $sshParams,
    'deploy' => array(
      'local_base_dir' => $localBaseDir,
      'remote_base_dir' => "/var/www/myfantasticserver/",
      // 'rsync_exclude_file' => 'rsync_exclude.txt'
      // 'rsync_include_file' => 'rsync_include.txt'
      // 'migrations' => true
      // 'strategy' => 'Copy'
    ),
  ),
);

$idx = new Idephix($targets);

$idx->
  /**
   * Symfony2 basic deploy
   */
  add('sf2:deploy',
    function($go = false) use ($idx)
    {
      if (!$go) {
        echo "\nDry Run...\n";
      }
      $idx->deploySF2Copy($go);
    })->
  /**
   * Build your Symfony project after you have downloaded it for the first time
   */
  add('build:fromscratch',
    function () use ($idx)
    {
      if (!file_exists(__DIR__.'/composer.phar')) {
        $idx->output->writeln("Downloading composer.phar ...");
        $idx->local("curl -sS https://getcomposer.org/installer | php");
      }

      $idx->local("php composer.phar update");
      $idx->local("./app/console doctrine:schema:update --force");
      $idx->runTask('asset:install');
      $idx->local("./app/console cache:clear");
      $idx->runTask('test:run');
    })->
  /**
   * Symfony2 installing assets and running assetic command
   */
  add('asset:install',
    function () use ($idx)
    {
      $idx->local("app/console assets:install web");
      $idx->local("app/console assetic:dump");
    })->
  /**
   * run phpunit tests
   */
  add('test:run',
    function () use ($idx)
    {
      $idx->runPhpUnit('-c app/');
    })
  ;

$idx->addLibrary('deploy', new Deploy());
$idx->addLibrary('phpunit', new PHPUnit());

$idx->run();

</code></pre>

<p>run <code>idephix.phar</code> to execute the script and get the commands list</p>
<pre><code>$ ./idephix.phar
  ___    _            _     _
 |_ _|__| | ___ _ __ | |__ (_)_  __
  | |/ _` |/ _ \ '_ \| '_ \| \ \/ /
  | | (_| |  __/ |_) | | | | |&gt;  &lt;
 |___\__,_|\___| .__/|_| |_|_/_/\_\
               |_|
Idephix version @package_version@

Usage:
  [options] command [arguments]

Options:
  --help           -h Display this help message.
  --quiet          -q Do not output any message.
  --verbose        -v Increase verbosity of messages.
  --version        -V Display this application version.
  --ansi              Force ANSI output.
  --no-ansi           Disable ANSI output.
  --no-interaction -n Do not ask any interactive question.
  --env               Set remote environment.

Available commands:
  help              Displays help for a command
  init-idx-file     Create an example idxfile.php
  list              Lists commands
  selfupdate        Donwload and update Idephix
myscript
  myscript:local-touch	Execute the touch of a file named in input locally
  myscript:remote-touch	Execute the touch of a file named in input in a remote server
  myscript:touch        Execute the remote and local touch
</code></pre> 

<p>then you can choose to execute a standard options or the one defined in the <code>idxfile.php</code></p>

<pre><code>$ ./idephix.phar myscript:local-touch myFile.txt</code></pre>

<p>More <a href="./documentation.html">examples</a> to be published soon...</p>

<h3>Requirements</h3>
<p>PHP 5.3.2 or above, at least 5.3.12 recommended</p>

<h3>Authors</h3>
<p><a title="Kea" href="http://www.ideato.it/author/kea/">Manuel 'Kea' Baldassarri</a>, <a title="Orso" href="http://www.ideato.it/author/orso/">Michele 'Orso' Orselli</a>, <a title="filo" href="http://www.ideato.it/author/filo/">Filippo De Santis</a> and <a href="https://github.com/ideatosrl/idephix/graphs/contributors">other contributors</a></p>

<h3>License</h3>
<p>Idephix is mantained by <a href="http://www.ideato.it">ideato</a>, licensed under the MIT License - see the LICENSE file for details</p>

<h3>Support or Contact</h3>

<p>Having trouble with Idephix? Check out the documentation or ask us for direct support to <a mailto:"info@ideato.it">info@ideato.it</a> and weâ€™ll help you sort it out.</p>
